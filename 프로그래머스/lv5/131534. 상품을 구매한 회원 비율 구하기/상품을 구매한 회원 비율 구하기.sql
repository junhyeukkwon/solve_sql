-- 코드를 입력하세요
SELECT YEAR(sales_date) AS YEAR, MONTH(sales_date) AS MONTH, COUNT(DISTINCT s.user_id) AS PUCHASED_USERS, ROUND(COUNT(DISTINCT s.user_id) / (SELECT COUNT(USER_ID) FROM USER_INFO WHERE joined BETWEEN '2021-01-01 00:00:00' AND '2021-12-31 23:59:59'),1) AS PUCHASED_RATIO
FROM ONLINE_SALE s
    INNER JOIN USER_INFO i ON s.user_id = i.user_id
WHERE i.joined BETWEEN '2021-01-01 00:00:00' AND '2021-12-31 23:59:59'
GROUP BY YEAR, MONTH
ORDER BY YEAR, MONTH


